# Data Distillation using Trajectory Matching

**BLG454E Term Project - Spring 2024**

**Authors:**
*   Ömer Faruk San ([GitHub Profile Link](https://github.com/oemersan))
*   Mustafa Kerem Bulut ([GitHub Profile Link](https://github.com/mustafakerembulut))
---

## 1. Project Overview

This project is an implementation of "Dataset Distillation by Matching Training Trajectories," a technique proposed by Cazenavette et al. (2022). The goal is to synthesize a small, highly informative dataset from a larger one (CIFAR-10) that can be used to train models efficiently while retaining a degree of their original performance.

We successfully implemented a pipeline to:
1.  Train a "teacher" CNN on the full CIFAR-10 dataset and save its parameter trajectory.
2.  Optimize a small set of 100 synthetic images by matching the learning trajectory of a "student" model (trained on these images) to the teacher's trajectory.
3.  Evaluate the quality of the distilled dataset by training a new model from scratch and testing it on the original CIFAR-10 test set.

![Distilled Images](distilled_images_plot.png)
*Fig 1: The 100 distilled images (10 per class) generated by our algorithm.*

---

## 2. Key Results Summary

*   **Teacher Model (trained on 50,000 images):**
    *   **Test Accuracy:** **83.31%**
*   **Evaluation Model (trained on 100 distilled images):**
    *   **Test Accuracy:** **10.28%**

While the distilled dataset did not achieve high generalization in this implementation, the project successfully demonstrates the core mechanics of trajectory-based dataset distillation and provides a foundation for further exploration.

---

## 3. Repository Structure
.
├── data/ # Directory for CIFAR-10 dataset (auto-generated)
├── distilled_dataset_final.pth # The final saved 100 distilled images and labels
├── teacher_model.pth # Saved weights of the final teacher model
├── teacher_trajectory.pth # Saved parameter trajectory of the teacher model
├── dataset_distillation.ipynb # Jupyter Notebook with the full implementation and outputs
├── report.pdf # The final project report
├── presentation.pdf # The 3-minute presentation slides
└── README.md # This file

---
You can access the fully working jupyter notebook without errors from here 
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1cK0tppMQ3mIs1SUE71VJ0l4STgkIUolD?usp=sharing)
